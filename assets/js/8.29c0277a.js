(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{275:function(t,e,a){"use strict";a.r(e);var s=a(13),n=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"configdeliverclient-配置分发客户端"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configdeliverclient-配置分发客户端"}},[t._v("#")]),t._v(" configDeliverClient 配置分发客户端")]),t._v(" "),e("h2",{attrs:{id:"下载地址"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#下载地址"}},[t._v("#")]),t._v(" 下载地址")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"http://hjmcloud.gitee.io/config-deliver-client-release/linux_amd64/config-deliver-client",target:"_blank",rel:"noopener noreferrer"}},[t._v("linux_amd64"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"http://hjmcloud.gitee.io/config-deliver-client-release/linux_386/config-deliver-client",target:"_blank",rel:"noopener noreferrer"}},[t._v("linux_386"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"http://hjmcloud.gitee.io/config-deliver-client-release/darwin_amd64/config-deliver-client",target:"_blank",rel:"noopener noreferrer"}},[t._v("darwin_amd64"),e("OutboundLink")],1)])]),t._v(" "),e("h2",{attrs:{id:"配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置文件"}},[t._v("#")]),t._v(" 配置文件")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# config.yaml 位于应用同级目录")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("logger")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("level")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"info"')]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("stdout")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiServer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//config.lidong.xin/getconfig "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# api server address")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("tasks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"5472E3F6-37DE-B9A0-899C-39838E8C1336"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 任务名称")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("file")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 文件名")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("corn")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"@every 1m"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# corn表达式")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("localDir")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./localDir/5472E3F6-37DE-B9A0-899C-39838E8C1336"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 本地目录")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("isRunOnStart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 是否启动时执行一次")]),t._v("\n")])])]),e("h2",{attrs:{id:"systemd-部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#systemd-部署"}},[t._v("#")]),t._v(" systemd 部署")]),t._v(" "),e("p",[t._v("本部署方式仅支持 linux 系统,且需要安装 systemd.")]),t._v(" "),e("h3",{attrs:{id:"在线安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#在线安装"}},[t._v("#")]),t._v(" 在线安装")]),t._v(" "),e("p",[t._v("进入要安装到的目录，执行以下命令")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -sSL https://gitee.com/hjmcloud/scripts/raw/master/config-deliver-client/systemd/config-deliver-client-install.sh "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v("\n")])])]),e("h3",{attrs:{id:"在线卸载"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#在线卸载"}},[t._v("#")]),t._v(" 在线卸载")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -sSL https://gitee.com/hjmcloud/scripts/raw/master/config-deliver-client/systemd/config-deliver-client-uninstall.sh "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v("\n")])])]),e("h3",{attrs:{id:"管理服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#管理服务"}},[t._v("#")]),t._v(" 管理服务")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动服务")]),t._v("\nsystemctl start config-deliver-client\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 停止服务")]),t._v("\nsystemctl stop config-deliver-client\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 重启服务")]),t._v("\nsystemctl restart config-deliver-client\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看服务状态")]),t._v("\nsystemctl status config-deliver-client\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看服务日志")]),t._v("\njournalctl -u config-deliver-client -f\n")])])]),e("h2",{attrs:{id:"docker-compose-部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-部署"}},[t._v("#")]),t._v(" Docker compose 部署")]),t._v(" "),e("p",[t._v("下载示例文件")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" https://gitee.com/hjmcloud/config-deliver-client/raw/master/docker-compose.yml -O docker-compose.yml\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" https://gitee.com/hjmcloud/config-deliver-client/raw/master/config.yaml -O config.yaml\n")])])]),e("p",[t._v("目录结构如下")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n├── config.yaml\n└── docker-compose.yml\n")])])]),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker-compose.yml")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3.7"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("config-deliver-client")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hjmcloud/config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("deliver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("client"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("latest\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" config"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("deliver"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("client\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./config.yaml"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/app/config.yaml\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./localDir"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/app/localDir\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" TZ=Asia/Shanghai\n")])])]),e("h2",{attrs:{id:"goframe-template-for-singlerepo"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#goframe-template-for-singlerepo"}},[t._v("#")]),t._v(" GoFrame Template For SingleRepo")]),t._v(" "),e("p",[t._v("Project Makefile Commands:")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("make cli")]),t._v(": Install or Update to the latest GoFrame CLI tool.")]),t._v(" "),e("li",[e("code",[t._v("make dao")]),t._v(": Generate go files for "),e("code",[t._v("Entity/DAO/DO")]),t._v(" according to the configuration file from "),e("code",[t._v("hack")]),t._v(" folder.")]),t._v(" "),e("li",[e("code",[t._v("make service")]),t._v(": Parse "),e("code",[t._v("logic")]),t._v(" folder to generate interface go files into "),e("code",[t._v("service")]),t._v(" folder.")]),t._v(" "),e("li",[e("code",[t._v("make image TAG=xxx")]),t._v(": Run "),e("code",[t._v("docker build")]),t._v(" to build image according "),e("code",[t._v("manifest/docker")]),t._v(".")]),t._v(" "),e("li",[e("code",[t._v("make image.push TAG=xxx")]),t._v(": Run "),e("code",[t._v("docker build")]),t._v(" and "),e("code",[t._v("docker push")]),t._v(" to build and push image according "),e("code",[t._v("manifest/docker")]),t._v(".")]),t._v(" "),e("li",[e("code",[t._v("make deploy TAG=xxx")]),t._v(": Run "),e("code",[t._v("kustomize build")]),t._v(" to build and deploy deployment to kubernetes server group according "),e("code",[t._v("manifest/deploy")]),t._v(".")]),t._v(" "),e("li",[e("code",[t._v("make bin.publish")]),t._v(": build and publish binary files to gitee pages.")])])])}),[],!1,null,null,null);e.default=n.exports}}]);