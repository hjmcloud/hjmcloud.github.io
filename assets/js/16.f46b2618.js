(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{283:function(t,s,a){"use strict";a.r(s);var e=a(13),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[t._v("#")]),t._v(" 配置")]),t._v(" "),s("h2",{attrs:{id:"默认配置目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#默认配置目录"}},[t._v("#")]),t._v(" 默认配置目录")]),t._v(" "),s("p",[t._v("默认配置文件名为 "),s("code",[t._v("config.xxx")]),t._v(".将按优先级查找"),s("code",[t._v("toml/yaml/yml/json/ini/xml/properties")]),t._v("格式的配置文件.")]),t._v(" "),s("p",[t._v("服务启动时,会按以下顺序查找配置文件:")]),t._v(" "),s("ol",[s("li",[t._v("运行目录")]),t._v(" "),s("li",[t._v("运行目录下的"),s("code",[t._v("config")]),t._v("子目录")]),t._v(" "),s("li",[t._v("运行目录下的"),s("code",[t._v("mainfest/config")]),t._v("目录")]),t._v(" "),s("li",[t._v("程序目录")]),t._v(" "),s("li",[t._v("程序目录下的"),s("code",[t._v("config")]),t._v("子目录")]),t._v(" "),s("li",[t._v("程序目录下的"),s("code",[t._v("mainfest/config")]),t._v("目录")])]),t._v(" "),s("h2",{attrs:{id:"指定配置文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#指定配置文件"}},[t._v("#")]),t._v(" 指定配置文件")]),t._v(" "),s("p",[t._v("在需要的时候,可以指定配置文件.")]),t._v(" "),s("h3",{attrs:{id:"通过命令行参数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#通过命令行参数"}},[t._v("#")]),t._v(" 通过命令行参数")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("./hjm-certcheck --gf.gcfg.file"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("config.prod.toml\n")])])]),s("h3",{attrs:{id:"通过环境变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#通过环境变量"}},[t._v("#")]),t._v(" 通过环境变量")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("GF_GCFG_FILE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("config.prod.toml\n./hjm-certcheck\n")])])]),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[t._v("DANGER")]),t._v(" "),s("p",[t._v("为了避免环境变量冲突,你应该在 shell 脚本中使用"),s("code",[t._v("export")]),t._v("命令来设置环境变量.")]),t._v(" "),s("p",[t._v("或者在 Docker 中使用"),s("code",[t._v("-e")]),t._v("参数来设置环境变量.")])]),t._v(" "),s("h2",{attrs:{id:"配置文件示例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置文件示例"}},[t._v("#")]),t._v(" 配置文件示例")]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# config.yaml for HJMCertcheck service.")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 日志配置")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("logger")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("level")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"info"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("stdout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 计划任务")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cron")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("pattern")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0 0 8 * * *"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  任务计划 使用CRON语法格式,参考 https://goframe.org/pages/viewpage.action?pageId=30736411")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("runOnStart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 是否在服务启动时执行一次 ture/false")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("##### 以上配置项修改后需要重启生效,以下为动态配置,修改后可直接生效#####")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 剩余多少天提醒")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("warnLeftDays")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 钉钉机器人配置")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dingTalk")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("false")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 是否启用钉钉通知 true/false")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("accessToken")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 钉钉机器人accessToken")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("secret")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 钉钉机器人secret")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 要检测的项目列表")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("urls")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://www.baidu.com"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://www.163.com"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://www.sohu.com"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://www.hjmcloud.cn"')])])])])])}),[],!1,null,null,null);s.default=n.exports}}]);